(()=>{"use strict";function t(t,e){const i=e.replaceAll(" ","").split(",");for(const e of i)if(Number.isNaN(Number(e))){const i=e.split("-"),s=Number(i[0]),n=Number(i[1]);if(!Number.isNaN(s)&&!Number.isNaN(n)){const e=i[1].length;let r=t.slice(0,e);if(r=Number(r),r>=s&&r<=n)return!0}}else if(t.startsWith(e))return!0;return!1}function e(t,e){const i=Number(e);if(Number.isNaN(i)){if(e.includes("-")){const i=e.split("-"),s=Number(i[0]),n=Number(i[1]);if(t.length>=s&&t.length<=n)return!0}if(e.includes(",")){const i=e.split(",");for(const e of i)if(t.length===Number(e))return!0}}else if(t.length===i)return!0;return!1}class i{constructor(t,e){this.widget=t,this.cards=e}init(){this.widget.bindToDOM(),this.widget.drawIconsCards(this.cards),this.widget.addSubmitListeners(this.onSubmit.bind(this)),this.widget.addInputListeners(this.onInput.bind(this))}onSubmit(){!function(t){const e=Number(t.slice(-1));let i=0,s=!0;for(let e=t.length-2;e>=0;e-=1){let n=0,r=t.charAt(e);s?(r*=2,s=!1):s=!0,n=Math.trunc(r/10)+r%10,i+=n}return(10-i%10)%10===e}(this.widget.input.value.replaceAll(" ",""))?(this.widget.input.classList.remove("valid"),this.widget.input.classList.add("invalid")):(this.widget.input.classList.remove("invalid"),this.widget.input.classList.add("valid"))}onInput(s){this.widget.input.classList.remove("invalid"),this.widget.input.classList.remove("valid");let{value:n}=this.widget.input;if(!Number.isFinite(Number(s.data))||" "===s.data)return void(this.widget.input.value=n.slice(0,n.length-1));n=n.replaceAll(" ",""),this.widget.input.value=i.repeatInputValue(n);const r=function(i,s){if(i.length>=6){const n=i.slice(0,6);for(const r of s){const s=t(n,r.diapazon),a=e(i,r.lengthNumber);if(s&&a)return r.title}}return!1}(n,this.cards);this.widget.setDeactiveCard(),r&&this.widget.setActiveCard(r)}static repeatInputValue(t){const e=Math.floor(t.length/4);let i=String();if(e>0){let s=0;for(let n=0;n<e+1;n+=1)i+=t.slice(s,4+4*n),i+=" ",s=4+4*n}else i=t;return i.trim()}}const s=JSON.parse('{"i":[{"title":"Discover","diapazon":"6011, 622126-622925, 644-649, 65","lengthNumber":"16-19"},{"title":"VISA","diapazon":"4","lengthNumber":"13, 16"},{"title":"MIR","diapazon":"2200-2204","lengthNumber":"16-19"},{"title":"Mastercard","diapazon":"51-55,2221-2720","lengthNumber":"16"},{"title":"JCB","diapazon":"3528-3589","lengthNumber":"16-19"},{"title":"Diners-club","diapazon":"36,300-305,3095,38,39","lengthNumber":"16-19"},{"title":"American-express","diapazon":"34,37","lengthNumber":"15"},{"title":"Maestro","diapazon":"5018,5020,5038,5893,6304,6759,6766,6762,6763","lengthNumber":"12-19"}]}'),n=document.querySelector("body"),r=new class{constructor(t){this.parent=t,this.form=null,this.input=null,this.submitListeners=[],this.inputListeners=[]}bindToDOM(){const t=this.createWidget();this.parent.append(t),this.form.addEventListener("submit",(t=>this.onSubmit(t))),this.input.addEventListener("input",(t=>this.onInput(t)))}createWidget(){const t=document.createElement("main");t.classList.add("content");const e=document.createElement("div");e.classList.add("conteiner_money_sistem"),t.append(e),this.form=document.createElement("form"),this.form.classList.add("conteiner_input_data"),t.append(this.form),this.input=document.createElement("input"),this.input.classList.add("form_text"),this.input.type="text",this.input.setAttribute("placeholder","0000 0000 0000 0000"),this.input.setAttribute("maxlength","24"),this.form.append(this.input);const i=document.createElement("button");return i.classList.add("form_button"),i.type="submit",i.textContent="Click to Validate",this.form.append(i),t}drawIconsCards(t){for(const e of t){const t=this.parent.querySelector(".conteiner_money_sistem"),i=document.createElement("div");i.classList.add("card_money_sistem"),i.setAttribute("id",e.title),i.classList.add("disable"),t.append(i)}}onSubmit(t){t.preventDefault(),this.submitListeners.forEach((t=>t.call(null)))}addSubmitListeners(t){this.submitListeners.push(t)}onInput(t){t.preventDefault(),this.inputListeners.forEach((e=>e.call(null,t)))}addInputListeners(t){this.inputListeners.push(t)}setActiveCard(t){const e=`#${t}`,i=this.parent.querySelector(e);i.classList.remove("disable"),i.classList.add("active")}setDeactiveCard(){const t=this.parent.querySelector(".conteiner_money_sistem");for(const e of t.children)e.classList.contains("active")&&(e.classList.add("disable"),e.classList.remove("active"))}}(n);new i(r,s.i).init()})();